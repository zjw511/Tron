# 表格节点快速参考 📊

## 一分钟上手

### 1. 安装依赖
```bash
pip install pandas openpyxl
```

### 2. 启动服务器
```bash
python full_server.py
# 或双击 START_FULL.bat
```

### 3. 打开浏览器
```
http://127.0.0.1:8188
```

### 4. 创建工作流
```
LoadCSV节点 → PreviewTable节点
```

### 5. 配置节点
- **LoadCSV**：
  - `file_path`: `examples/sample_data.csv`
  
- **PreviewTable**：
  - `max_rows`: `100`
  - `title`: `我的数据表`

### 6. 执行
点击 **Queue Prompt**，表格会自动弹出！

---

## 4个核心节点

| 节点 | 功能 | 输入 | 输出 |
|------|------|------|------|
| 📄 LoadCSV | 加载CSV | file_path, encoding, separator | TABLE_DATA |
| 📊 LoadExcel | 加载Excel | file_path, sheet_name | TABLE_DATA |
| 🔄 DataFrameToTable | 转换数据 | any data | TABLE_DATA |
| 👁️ PreviewTable | 显示表格 | TABLE_DATA, max_rows, title | (输出节点) |

---

## 常用工作流模板

### 模板1：查看CSV
```
LoadCSV → PreviewTable
```

### 模板2：查看Excel多个工作表
```
LoadExcel(sheet=0) → PreviewTable(title="Sheet1")
LoadExcel(sheet=1) → PreviewTable(title="Sheet2")
```

### 模板3：信号数据表格化
```
NetworkReceiver → SignalAnalyzer → DataFrameToTable → PreviewTable
```

### 模板4：数据对比
```
LoadCSV(data1.csv) → PreviewTable
LoadCSV(data2.csv) → PreviewTable
```

---

## 表格UI特性

- ✅ 暗色主题
- ✅ 固定表头（滚动时可见）
- ✅ 显示数据类型
- ✅ 行索引编号
- ✅ 交替行颜色
- ✅ 支持大数据（可配置显示行数）
- ✅ 点击节点重新打开
- ✅ ESC键关闭

---

## 支持的数据格式

### 输入格式
- ✅ CSV文件
- ✅ Excel文件 (.xlsx, .xls)
- ✅ Pandas DataFrame
- ✅ Python字典
- ✅ Python列表
- ✅ NumPy数组

### 数据类型显示
- 整数：`int64`
- 浮点数：`float64` (保留4位小数)
- 字符串：`object`
- 布尔值：绿色/红色标识
- 空值：灰色 `null`

---

## 快速测试

### 方法1：使用测试脚本
```bash
双击 测试表格节点.bat
```

### 方法2：手动测试
```bash
# 1. 启动服务器
python full_server.py

# 2. 浏览器打开
http://127.0.0.1:8188

# 3. 创建节点
LoadCSV → PreviewTable

# 4. 配置LoadCSV
file_path = examples/sample_data.csv

# 5. 运行
点击 Queue Prompt
```

---

## 故障排除

### Q: 节点找不到？
**A**: 检查控制台是否显示：
```
[OK] Loaded 4 table nodes: ['PreviewTable', 'LoadCSV', 'LoadExcel', 'DataFrameToTable']
```

### Q: 表格不显示？
**A**: 
1. 按F12打开浏览器Console查看错误
2. 确认 `web_extensions/tablePreview.js` 存在
3. 强制刷新：Ctrl+Shift+R

### Q: 加载CSV失败？
**A**: 检查：
- 文件路径是否正确（相对于项目根目录）
- 文件编码（中文试试 `gbk`）
- 分隔符是否正确

### Q: 中文乱码？
**A**: 在LoadCSV节点设置：
```
encoding = gbk
```

---

## 性能建议

| 数据量 | max_rows建议 | 说明 |
|--------|--------------|------|
| < 1K行 | 1000 | 全部显示 |
| 1K-10K | 100-500 | 采样显示 |
| 10K-100K | 100 | 只看前100行 |
| > 100K | 50 | 快速预览 |

---

## 键盘快捷键

| 快捷键 | 功能 |
|--------|------|
| **ESC** | 关闭表格 |
| **F12** | 打开开发者工具 |
| **Ctrl+R** | 刷新页面 |
| **Ctrl+Shift+R** | 强制刷新 |

---

## 文件位置

```
simple_comfyui/
├── table_nodes.py              ← 后端节点定义
├── web_extensions/
│   └── tablePreview.js         ← 前端显示组件
├── examples/
│   └── sample_data.csv         ← 示例数据
├── docs/
│   └── TABLE_NODES_README.md   ← 完整文档
└── 表格节点快速参考.md          ← 本文档
```

---

## 下一步

### 详细文档
📖 [docs/TABLE_NODES_README.md](docs/TABLE_NODES_README.md)

### 项目主页
🏠 [README.md](README.md)

### 反馈问题
💬 提交 Issue 或 Pull Request

---

**快速开始，享受表格数据的直观展示！** 📊✨

